#Problem 65 Solutions

```elm
import Html
import List


type Tree a
    = Empty
    | Node a (Tree a) (Tree a)


tree65 = 
    Node 'n'
        (Node 'k'
            (Node 'c'
                (Node 'a' Empty Empty)
                (Node 'e'
                    (Node 'd' Empty Empty)
                    (Node 'g' Empty Empty)))
            (Node 'm' Empty Empty))
        (Node 'u'
            (Node 'p' 
                Empty 
                (Node 'q' Empty Empty)) 
            Empty)



{-| Given a Tree return a tree that adds x, y coordinates for each node
    to layout a graphic representation of the tree
-}
layout : Tree comparable -> Tree ( comparable, (Int, Int) )
layout tree =
    let
        ld = leftDepth 0 tree
        x = 2 ^ ld - 1
        sep = x
        sep' = sep // 2
    in
        case tree of
            Empty ->
                Empty

            Node n left right ->
                Node ( n, (x, 1) )
                    (layout' (x - sep' - 1) 2 sep' left)
                    (layout' (x + sep' + 1) 2 sep' right)


layout' : Int -> Int -> Int -> Tree comparable -> Tree ( comparable, (Int, Int) )
layout' x y sep tree =
    let
        sep' = sep // 2
    in
        case tree of
            Empty ->
                Empty

            Node n left right ->
                Node ( n, (x, y) )
                    (layout' (x - sep' - 1) (y + 1) sep' left)
                    (layout' (x + sep' + 1) (y + 1) sep' right)


depth : Int -> Tree a -> Int
depth d tree =   
    case tree of 
        Empty -> 
            d

        Node v left right ->
            max (depth (d + 1) left) (depth (d + 1) right)


-- apply a function to each node, passing the depth as a parameter
leftDepth : Int -> Tree a -> Int
leftDepth d tree =   
    case tree of 
        Empty -> 
            d

        Node v left right ->
            max (leftDepth (d + 1) left) (leftDepth (d - 1) right)

main =
    Html.text
        (if (test) then
            "Your implementation passed all tests."
         else
            "Your implementation failed at least one test."
        )


test : Bool
test =
    let 
        t = layout tree65 
    in 
        List.all ((==) True)
          [ t == layout65
          ]

layout65 = 
    Node ('n', (15, 1))
        (Node ('k', (7, 2))
            (Node ('c', (3, 3))
                (Node ('a', (1, 4)) Empty Empty)
                (Node ('e', (5, 4))
                    (Node ('d', (4, 5)) Empty Empty)
                    (Node ('g', (6, 5)) Empty Empty)))
            (Node ('m', (11, 3)) Empty Empty))
        (Node ('u', (23, 2))
            (Node ('p', (19, 3)) 
                Empty 
                (Node ('q', (21, 4)) Empty Empty)) 
            Empty)

```
[Back to problem](../p/p65.md)